"use strict";var teamItems=document.querySelector("#team-menu").querySelectorAll(".fourth__item"),burgersItems=document.querySelector("#burgers-menu").querySelectorAll(".fifth__link");function createAccordionMenu(r,n){r.forEach(function(e){e.addEventListener("click",function(t){t.preventDefault(),r.forEach(function(e){t.currentTarget!=e&&e.classList.remove(n)}),e.classList.toggle(n)})})}createAccordionMenu(teamItems,"fourth__item--active"),createAccordionMenu(burgersItems,"fifth__link--active");var formSectionOne=document.querySelector("#form-sectionone"),formTextarea=document.querySelector("#form-textarea"),orderForm=document.querySelector("#order-form"),orderSection=document.querySelector("#order-section"),orderOverlay=document.createElement("div");orderOverlay.innerHTML=document.querySelector("#order-overlay").innerHTML,orderOverlay.classList.add("overlay"),orderOverlay.classList.add("overlay--rewievs");var orderCloseBtn=orderOverlay.querySelector("#order-close-btn");function createReq(a){return new Promise(function(e,t){var r=new XMLHttpRequest,n=a.method,i=a.action,o=new FormData(a);r.open(n,i,!0),r.send(o),r.onerror=function(e){t(e)},r.onreadystatechange=function(){4==r.readyState&&("OK"==r.responseText?e(r.responseText):t(r.responseText))}})}function createOrderModalWindow(e,t,r){r||(r="no response"),t.querySelector(".order-modal__text").innerText=r,e.appendChild(t)}formTextarea.addEventListener("focus",function(e){orderForm.getBoundingClientRect().width<=480&&(formSectionOne.classList.add("form__column--hide"),orderSection.classList.add("seventh--textarea"))}),formTextarea.addEventListener("focusout",function(e){formSectionOne.classList.remove("form__column--hide"),orderSection.classList.remove("seventh--textarea")}),orderCloseBtn.addEventListener("click",function(e){e.preventDefault(),body.removeChild(orderOverlay)}),orderForm.addEventListener("submit",function(e){e.preventDefault(),createReq(orderForm).then(function(e){createOrderModalWindow(body,orderOverlay,e)},function(e){createOrderModalWindow(body,orderOverlay,e)})});var myMap,body=document.body,button=document.querySelector("#hamburger"),overlay=createOverlay();function createOverlay(){var e=document.querySelector("#logo").cloneNode(!0),t=document.querySelector("#main-menu .header-menu__list").cloneNode(!0),r=t.querySelectorAll(".nav-btn");t.querySelectorAll("*").forEach(function(e){e.classList=null});var n=document.createElement("div");n.innerHTML=document.querySelector("#main-overlay").innerHTML,n.classList.add("overlay");var i=document.createElement("a");return i.classList.add("close-btn"),i.href="#",i.addEventListener("click",function(e){e.preventDefault(),n.style.display="none"}),t.classList.add("overlay__list"),r.forEach(function(e){e.classList.add("overlay__link"),e.classList.add("nav-btn"),e.parentNode.classList.add("overlay__item"),e.addEventListener("click",function(e){e.preventDefault(),n.style.display="none"})}),n.querySelector("header").appendChild(e),n.querySelector("header").appendChild(i),n.querySelector("nav").appendChild(t),n}body.appendChild(overlay),button.addEventListener("click",function(e){e.preventDefault(),overlay.style.display="flex"}),ymaps.ready(init);var coords=[[59.961368,30.288778],[59.913992,30.302168],[59.944665,30.373579],[59.931572,30.435377]];function init(){var r;(myMap=new ymaps.Map("map",{center:[59.941392,30.293756],zoom:12,controls:["zoomControl"]})).behaviors.disable("scrollZoom"),(r=[],coords.forEach(function(e){var t=new ymaps.Placemark([e[0],e[1]],{},{iconLayout:"default#image",iconImageHref:"img/icons/map-marker.png",iconImageSize:[46,57],iconImageOffset:[0,0]});r.push(t)}),r).forEach(function(e){myMap.geoObjects.add(e)})}var onPageScrollWrapper=document.querySelector("#wrapper-scroll"),onePageScrollAnimationDuration=900,sectionsArray=onPageScrollWrapper.querySelectorAll("section"),section=onPageScrollWrapper.querySelector("section"),sectionsArrayMaxPosition=sectionsArray.length-1,navBtns=document.querySelectorAll(".nav-btn"),asideNavigation=document.querySelectorAll(".navigation__link"),sectionHeight=parseInt(getComputedStyle(section).height),isBeingAnimated=!1,sectionPosition=0,mobileStartY=0;window.addEventListener("resize",function(){delayFunc(function(){resizeWindow()},1e3)});var delayFunc=function(){var r=0;return function(e,t){clearTimeout(r),r=setTimeout(e,t)}}();function resizeWindow(){if(sectionHeight=parseInt(getComputedStyle(section).height),sliderItemHeight=parseInt(getComputedStyle(sliderItem).width),!isBeingAnimated){var e=-1*sectionHeight*sectionPosition;onPageScrollWrapper.style.transform="translate(0, "+e+"px)";var t=-1*sliderItemHeight*sliderCurentPosition;slider.style.transform="translate("+t+"px, 0)"}}function touchMove(e){var t=e.touches;if(t&&t.length){var r=mobileStartY-t[0].pageY;isBeingAnimated||(50<r&&sectionPosition<sectionsArrayMaxPosition&&(isBeingAnimated=!0,onePageScrollPrepareToAnimate("up"),document.removeEventListener("touchmove",touchMove)),r<-50&&0<sectionPosition&&(isBeingAnimated=!0,onePageScrollPrepareToAnimate("down"),document.removeEventListener("touchmove",touchMove)))}}function onePageScrollPrepareToAnimate(e){isBeingAnimated=!0;var t=getcurrentPosition(sectionPosition),r=0,n=onePageScrollAnimationDuration;"down"===e?r=(sectionPosition-1)*-sectionHeight:"up"===e&&(r=(sectionPosition+1)*-sectionHeight),setActiveItemInNavMenu(r,sectionHeight),animateTranslate(onPageScrollWrapper,"translateY",t,r,n).then(function(){isBeingAnimated=!1})}function getcurrentPosition(e){return-e*sectionHeight}function animateTranslate(a,s,l,c,d){return new Promise(function(i){var o=Date.now();requestAnimationFrame(function e(){var t=Date.now(),r=o+d-t;if(r<=0)a.style.transform=s+"("+c+"px)",i();else{var n=l+1/d*(d-r)*(c-l);a.style.transform=s+"("+n+"px)",requestAnimationFrame(e)}})})}function setActiveItemInNavMenu(e,t){var r=Math.abs(parseInt(e/t));asideNavigation.forEach(function(e){e.parentNode.classList.remove("navigation__item--active")}),asideNavigation[r].parentNode.classList.add("navigation__item--active"),sectionPosition=r}document.addEventListener("touchstart",function(e){var t=e.touches;t&&t.length&&(mobileStartY=t[0].pageY,document.addEventListener("touchmove",touchMove))}),document.addEventListener("wheel",function(e){isBeingAnimated||(e.deltaY<0&&0<sectionPosition&&onePageScrollPrepareToAnimate("down"),0<e.deltaY&&sectionPosition<sectionsArrayMaxPosition&&onePageScrollPrepareToAnimate("up"))}),navBtns.forEach(function(i){i.addEventListener("click",function(e){if(e.preventDefault(),!isBeingAnimated){isBeingAnimated=!0;var t=document.querySelector(i.hash),r=getcurrentPosition(sectionPosition),n=-t.offsetTop;setActiveItemInNavMenu(n,sectionHeight),animateTranslate(onPageScrollWrapper,"translateY",r,n,onePageScrollAnimationDuration).then(function(){isBeingAnimated=!1})}})});var reviewsList=document.querySelector("#reviews-list"),reviewsBtns=reviewsList.querySelectorAll(".sixth__inner-link"),reviewsOverlay=createReviewsOverlay(),reviewsOverlayBtn=reviewsOverlay.querySelector("#reviews-overlay-btn");function createReviewsOverlay(){var e=document.createElement("div");return e.innerHTML=document.querySelector("#reviews-overlay").innerHTML,e.classList.add("overlay"),e.classList.add("overlay--rewievs"),e}reviewsBtns.forEach(function(e){e.addEventListener("click",function(e){var t=e.target.parentNode.querySelector(".sixth__inner-text").innerText,r=e.target.parentNode.querySelector(".sixth__inner-title").innerText;e.preventDefault(),reviewsOverlay.querySelector(".overlay__title").innerText=r,reviewsOverlay.querySelector(".overlay__text").innerText=t,body.appendChild(reviewsOverlay)})}),reviewsOverlayBtn.addEventListener("click",function(e){e.preventDefault(),body.removeChild(reviewsOverlay)});var slider=document.querySelector("#slider-list"),sliderItemsNumber=slider.querySelectorAll("li").length-1,sliderItem=slider.querySelector("li"),sliderLeftBtn=document.querySelector("#slider-left"),sliderRightBtn=document.querySelector("#slider-right"),sliderItemHeight=parseInt(getComputedStyle(sliderItem).width),sliderCurentPosition=0;function getSliderCurentPosition(e,t){return-1*e*t}function sliderAnimationPrepare(e,t){var r=getSliderCurentPosition(sliderCurentPosition,sliderItemHeight);isBeingAnimated=!0,animateTranslate(e,"translateX",t,r,1e3).then(function(){isBeingAnimated=!1})}sliderRightBtn.addEventListener("click",function(e){if(e.preventDefault(),!isBeingAnimated){var t=getSliderCurentPosition(sliderCurentPosition,sliderItemHeight);sliderCurentPosition<sliderItemsNumber?sliderCurentPosition++:sliderCurentPosition=0,sliderAnimationPrepare(slider,t)}}),sliderLeftBtn.addEventListener("click",function(e){if(e.preventDefault(),!isBeingAnimated){var t=getSliderCurentPosition(sliderCurentPosition,sliderItemHeight);0<sliderCurentPosition?sliderCurentPosition--:sliderCurentPosition=sliderItemsNumber,sliderAnimationPrepare(slider,t)}});